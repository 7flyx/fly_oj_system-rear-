import"./request-DBKoyywz.js";import{_ as O,b as A}from"./question-CU5ZsbxS.js";/* empty css                  *//* empty css                  *//* empty css              */import{e as W,a as X,p as G,b as J,f as K,h as Z}from"./exam-Cm2pr6XW.js";import{_ as V,e as E,r as y,c as p,a as s,t as ee,u as q,b as t,g as i,d as w,R as x,E as te,Y as ae,O as oe,T as le,$ as se,o as r,i as m,V as ie,W as c,X as ne,N as de,P as ue,U as me}from"./index-01c_CFXq.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"add-exam-component-box"},ce={class:"add-exam-component"},fe={class:"exam-base-info-box"},_e={class:"exam-base-title"},xe={class:"base-title"},ve={class:"exam-base-info"},ye={class:"group-box"},ge={class:"group-item"},be={class:"group-box"},Ee={class:"group-item"},ke={class:"group-box"},Ce={class:"group-item"},Ie={class:"exam-select-question-box"},De={key:0,style:{color:"#3EC8FF"}},Se={key:1,style:{color:"#FE7909"}},Ve={key:2,style:{color:"#FD4C40"}},qe={class:"exam-list-box"},we={key:0,style:{color:"#3EC8FF"}},he={key:1,style:{color:"#FE7909"}},ze={key:2,style:{color:"#FD4C40"}},Fe={class:"exam-question-list-button"},Ne={class:"submit-box absolute"},Qe={__name:"UpdateExam",setup(Te){const h=V().query.type,l=E({examId:"",title:"",examDate:""}),n=E({pageNum:1,pageSize:10,difficulty:"",title:""});function k(){w.go(-1)}async function z(){const a=new FormData;for(let e in l)e==="examDate"?(a.append("startTime",l.examDate[0]),a.append("endTime",l.examDate[1])):e!=="startTime"&&e!=="endTime"&&a.append(e,l[e]);if(l.examId)await W(a);else{const e=await X(a);l.examId=e.data}x.success("基本信息保存成功")}const C=y([]),I=y(0);async function f(){const a=await A(n);console.log(a),C.value=a.rows,I.value=a.total}const v=y(!1);function F(){l.examId===null||l.examId===""?x.error("请先保存竞赛基本信息"):(f(),v.value=!0)}function N(){n.pageNum=1,f()}function Q(){f()}function T(){n.pageNum=1,f()}function U(){n.pageNum=1,n.pageSize=10,n.title="",n.difficulty="",f()}async function B(){await G(l.examId),w.push("/oj/layout/exam")}const _=y([]);function L(a){_.value=[],a.forEach(e=>{_.value.push(e.questionId)})}async function R(){if(_.value&&_.value.length<1)return x.error("请先选择要提交的题目"),!1;const a=E({examId:l.examId,questionIdSet:_.value});console.log(a),await K(a),g(l.examId),v.value=!1,x.success("竞赛题目添加成功")}async function Y(){const a=V().query.examId;a&&(l.examId=a,g(a))}Y();async function P(a,e){await Z(a,e),g(a),x.success("竞赛题目删除成功")}async function g(a){const e=await J(a);l.examQuestionList=[],console.log(l.examQuestionList),Object.assign(l,e.data),l.examDate=[e.data.startTime,e.data.endTime]}return(a,e)=>{const D=te,$=ae,d=oe,u=ne,S=le,b=de,j=ue,M=me,H=se;return r(),p("div",re,[s("div",ce,[s("div",fe,[s("div",_e,[s("span",xe,ee(q(h)==="edit"?"编辑竞赛":"添加竞赛"),1),s("span",{class:"go-back",onClick:k},"返回")]),s("div",ve,[s("div",ye,[s("div",ge,[e[8]||(e[8]=s("div",{class:"item-label required"},"竞赛名称",-1)),s("div",null,[t(D,{modelValue:l.title,"onUpdate:modelValue":e[0]||(e[0]=o=>l.title=o),style:{width:"420px"},placeholder:"请填写竞赛名称"},null,8,["modelValue"])])])]),s("div",be,[s("div",Ee,[e[9]||(e[9]=s("div",{class:"item-label required"},"竞赛周期",-1)),s("div",null,[t($,{modelValue:l.examDate,"onUpdate:modelValue":e[1]||(e[1]=o=>l.examDate=o),disabledDate:a.disabledDate,type:"datetimerange","start-placeholder":"竞赛开始时间","end-placeholder":"竞赛结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","disabledDate"])])])]),s("div",ke,[s("div",Ce,[t(d,{class:"exam-base-info-button",type:"primary",plain:"",onClick:z},{default:i(()=>e[10]||(e[10]=[m("保存")])),_:1})])])])]),s("div",Ie,[t(d,{class:"exam-add-question",icon:q(ie),type:"text",onClick:e[2]||(e[2]=o=>F())},{default:i(()=>e[11]||(e[11]=[m(" 添加题目 ")])),_:1},8,["icon"]),t(S,{height:"526px",data:l.examQuestionList,class:"question-select-list"},{default:i(()=>[t(u,{prop:"questionId",width:"180px",label:"题目id"}),t(u,{prop:"title","show-overflow-tooltip":!0,label:"题目标题"}),t(u,{prop:"difficulty",width:"80px",label:"题目难度"},{default:i(({row:o})=>[o.difficulty===1?(r(),p("div",De,"简单")):c("",!0),o.difficulty===2?(r(),p("div",Se,"中等")):c("",!0),o.difficulty===3?(r(),p("div",Ve,"困难")):c("",!0)]),_:1}),t(u,{label:"操作",width:"80px"},{default:i(({row:o})=>[t(d,{circle:"",type:"text",onClick:Ue=>P(l.examId,o.questionId)},{default:i(()=>e[12]||(e[12]=[m(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),s("div",null,[t(H,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o)},{default:i(()=>[s("div",qe,[e[16]||(e[16]=s("div",{class:"exam-list-title required"},"选择竞赛题目",-1)),t(j,{inline:"true"},{default:i(()=>[t(b,{label:"题目难度"},{default:i(()=>[t(O,{modelValue:n.difficulty,"onUpdate:modelValue":e[3]||(e[3]=o=>n.difficulty=o),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),t(b,{label:"题目名称"},{default:i(()=>[t(D,{modelValue:n.title,"onUpdate:modelValue":e[4]||(e[4]=o=>n.title=o),placeholder:"请您输入要搜索的题目标题"},null,8,["modelValue"])]),_:1}),t(b,null,{default:i(()=>[t(d,{onClick:T,plain:""},{default:i(()=>e[13]||(e[13]=[m("搜索")])),_:1}),t(d,{onClick:U,plain:"",type:"info"},{default:i(()=>e[14]||(e[14]=[m("重置")])),_:1})]),_:1})]),_:1}),t(S,{data:C.value,onSelect:L},{default:i(()=>[t(u,{type:"selection"}),t(u,{prop:"questionId",label:"题目id"}),t(u,{prop:"title",label:"题目标题"}),t(u,{prop:"difficulty",label:"题目难度"},{default:i(({row:o})=>[o.difficulty===1?(r(),p("div",we,"简单")):c("",!0),o.difficulty===2?(r(),p("div",he,"中等")):c("",!0),o.difficulty===3?(r(),p("div",ze,"困难")):c("",!0)]),_:1})]),_:1},8,["data"]),s("div",Fe,[t(M,{background:"",size:"small",layout:"total, sizes, prev, pager, next, jumper",total:I.value,"current-page":n.pageNum,"onUpdate:currentPage":e[5]||(e[5]=o=>n.pageNum=o),"page-size":n.pageSize,"onUpdate:pageSize":e[6]||(e[6]=o=>n.pageSize=o),"page-sizes":[1,5,10,15,20],onSizeChange:N,onCurrentChange:Q},null,8,["total","current-page","page-size"]),t(d,{class:"question-select-submit",type:"primary",plain:"",onClick:R},{default:i(()=>e[15]||(e[15]=[m("提交")])),_:1})])])]),_:1},8,["modelValue"])]),s("div",Ne,[t(d,{type:"info",plain:"",onClick:k},{default:i(()=>e[17]||(e[17]=[m("取消")])),_:1}),t(d,{type:"primary",plain:"",onClick:B},{default:i(()=>e[18]||(e[18]=[m("发布竞赛")])),_:1})])])])}}},He=pe(Qe,[["__scopeId","data-v-f1aa1795"]]);export{He as default};
